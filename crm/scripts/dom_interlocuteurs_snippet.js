(async()=>{const e=t=>t?t.trim().replace(/\s+/g," "):"",n=t=>e(t).replace(/[^\d+]/g,""),o=t=>e(t).normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),a=t=>new Promise(e=>setTimeout(e,t)),r=["Direction/Dir. Générale","Gérant/Dirigeant","Ressource Humaine"].map(o),c=t=>{const n=e(t).replace(/^(M\.|Mme|Mlle|Mr|Ms|Dr)\.?\s*/i,""),o=n.split(" ").filter(Boolean);if(!o.length)return{firstName:"",lastName:""};if(1===o.length)return{firstName:o[0],lastName:""};return o[0]===o[0].toUpperCase()?{firstName:o.slice(1).join(" "),lastName:o[0][0]+o[0].slice(1).toLowerCase()}:{firstName:o[0],lastName:o.slice(1).join(" ")}};const l=()=>{const t=document.querySelectorAll(".accordion-item.inter"),a=new Set(),l=[];return t.forEach(t=>{const i=Array.from(t.querySelectorAll(".inter-item-title")).find(t=>o(t.textContent).startsWith("fonction")),s=e(i?.nextElementSibling?.textContent||"");if(!s)return;const f=r.some(t=>o(s).includes(t));if(!f)return;const d=t.querySelector("[id^='name-']")||t.querySelector(".accordion-button [id^='name-']")||t.querySelector(".accordion-button"),m=t.querySelector("[id^='mail-'] a")||t.querySelector("[id^='mail-']"),u=t.querySelector("[id^='mobile-']"),p=t.querySelector("[id^='fixe-']"),h=e(d?.textContent||""),{firstName:g,lastName:w}=c(h),x=e(m?.textContent||m?.getAttribute?.("href")||"")||"",b=x.startsWith("mailto:")?x.replace(/^mailto:/i,""):x,y=n(u?.textContent||""),E=n(p?.textContent||""),v=b?`e:${o(b)}`:`n:${o(g)}-${o(w)}|m:${y}|f:${E}`;a.has(v)||(a.add(v),l.push({firstName:g,lastName:w,email:b,mobile:y,fixe:E,fonction:s,category:r.find(t=>o(s).includes(t))}))}),l};const i=[];let s=1;for(;;){console.info("📄 page",s),i.push(...l());const t=document.querySelector("li.page-item:not(.disabled) a[aria-label='Next']");if(!t){console.info("✅ fin");break}t.click(),s++,await a(1200)}console.table(i);const f=JSON.stringify(i,null,2);prompt(`📋 ${i.length} contact(s) (Dir/Gérant/RH)\nCtrl+C puis Entrée:`,f);window.close()})();
