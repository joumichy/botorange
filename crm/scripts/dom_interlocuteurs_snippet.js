(async()=>{
  const c=t=>t?t.trim().replace(/\s+/g," "):"",d=t=>c(t).replace(/[^\d+]/g,""),n=t=>c(t).normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),w=t=>new Promise(r=>setTimeout(r,t)),k=["direction","gerant","dirigeant","ressource"].map(n),p=t=>{const e=c(t).replace(/^(M\.|Mme|Mlle|Mr|Ms|Dr)\.?\s*/i,"").split(" ").filter(Boolean);if(!e.length)return{firstName:"",lastName:""};if(e.length===1)return{firstName:e[0],lastName:""};return e[0]===e[0].toUpperCase()?{firstName:e.slice(1).join(" "),lastName:e[0][0]+e[0].slice(1).toLowerCase()}:{firstName:e[0],lastName:e.slice(1).join(" ")}},x=()=>{const e=document.querySelectorAll(".accordion-item.inter"),s=new Set(),r=[];e.forEach(t=>{const o=Array.from(t.querySelectorAll(".inter-item-title")).find(a=>n(a.textContent).startsWith("fonction")),i=c(o?.nextElementSibling?.textContent||"");if(!i)return;const l=k.some(a=>n(i).includes(a)),m=t.querySelector("[id^='name-']")||t.querySelector(".accordion-button [id^='name-']")||t.querySelector(".accordion-button"),f=t.querySelector("[id^='mail-'] a")||t.querySelector("[id^='mail-']"),b=t.querySelector("[id^='mobile-']"),y=t.querySelector("[id^='fixe-']"),h=c(m?.textContent||""),{firstName:g,lastName:j}=p(h),u=c(f?.textContent||f?.getAttribute?.("href")||""),E=u.startsWith("mailto:")?u.replace(/^mailto:/i,""):u,v=d(b?.textContent||""),C=d(y?.textContent||""),S=E?`e:${n(E)}`:`n:${n(g)}-${n(j)}|m:${v}|f:${C}`;if(s.has(S))return;s.add(S);r.push({firstName:g,lastName:j,email:E,mobile:v,fixe:C,fonction:i,category:l?"Ciblé":"Autre"})});return r};const A=[];for(;;){A.push(...x());const e=document.querySelector("li.page-item:not(.disabled) a[aria-label='Next']");if(!e)break;e.click();await w(3e3)}const T=A.filter(t=>t.category==="Ciblé"),O=A.filter(t=>t.category==="Autre").slice(0,3),L=[...T,...O],J=JSON.stringify(L,null,2);prompt(`📋 ${L.length} contact(s) (dont 3 "Autre")\nCtrl+C puis Entrée:`,J);window.close();
  })();
  